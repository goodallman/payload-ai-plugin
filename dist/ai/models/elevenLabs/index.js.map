{"version":3,"sources":["../../../../src/ai/models/elevenLabs/index.ts"],"sourcesContent":["import type { Field, File } from 'payload'\r\n\r\nimport type { GenerationConfig } from '../../../types.js'\r\n\r\nimport { generateFileNameByPrompt } from '../../utils/generateFileNameByPrompt.js'\r\nimport { generateVoice } from './generateVoice.js'\r\nimport { getAllVoices } from './voices.js'\r\n\r\nconst { voices = [] } = await getAllVoices()\r\n\r\nconst voiceOptions = voices.map((voice) => {\r\n  return {\r\n    label: voice.name,\r\n    value: voice.voice_id,\r\n    ...voice,\r\n  }\r\n})\r\n\r\nconst fieldVoiceOptions = voiceOptions.map((option) => {\r\n  return {\r\n    label: option.name,\r\n    value: option.voice_id,\r\n  }\r\n})\r\n\r\nconst fields: Field[] = [\r\n  {\r\n    type: 'collapsible',\r\n    admin: {\r\n      initCollapsed: false,\r\n    },\r\n    fields: [\r\n      {\r\n        name: 'stability',\r\n        type: 'number',\r\n        defaultValue: 0.5,\r\n        label: 'Stability',\r\n        max: 1,\r\n        min: 0,\r\n        required: true,\r\n      },\r\n      {\r\n        name: 'similarity_boost',\r\n        type: 'number',\r\n        defaultValue: 0.5,\r\n        label: 'Similarity Boost',\r\n        max: 1,\r\n        min: 0,\r\n        required: true,\r\n      },\r\n      {\r\n        name: 'style',\r\n        type: 'number',\r\n        defaultValue: 0.5,\r\n        label: 'Style',\r\n        max: 1,\r\n        min: 0,\r\n      },\r\n      {\r\n        name: 'use_speaker_boost',\r\n        type: 'checkbox',\r\n        label: 'Use Speaker Boost',\r\n      },\r\n    ],\r\n    label: 'Voice Settings',\r\n  },\r\n  {\r\n    name: 'seed',\r\n    type: 'number',\r\n    label: 'Seed',\r\n  },\r\n  {\r\n    type: 'row',\r\n    fields: [\r\n      {\r\n        name: 'previous_text',\r\n        type: 'textarea',\r\n        label: 'Previous Text',\r\n      },\r\n      {\r\n        name: 'next_text',\r\n        type: 'textarea',\r\n        label: 'Next Text',\r\n      },\r\n    ],\r\n  },\r\n]\r\n\r\nif (voiceOptions.length) {\r\n  fields.unshift({\r\n    name: 'voice_id',\r\n    type: 'select',\r\n    defaultValue: voiceOptions[0]?.voice_id,\r\n    label: 'Voice',\r\n    options: fieldVoiceOptions,\r\n    required: true,\r\n  })\r\n}\r\n\r\nconst MODEL_KEY = '11Labs'\r\n\r\nexport const ElevenLabsConfig: GenerationConfig = {\r\n  models: [\r\n    {\r\n      id: `${MODEL_KEY}-m-v2`,\r\n      name: 'ElevenLabs Multilingual v2',\r\n      fields: ['upload'],\r\n      handler: async (text: string, options) => {\r\n        const voiceData = await generateVoice(text, options)\r\n        return {\r\n          data: {\r\n            alt: 'voice over',\r\n          },\r\n          file: {\r\n            name: `voice_${generateFileNameByPrompt(text)}.mp3`,\r\n            data: voiceData.buffer,\r\n            mimetype: 'audio/mp3',\r\n            size: voiceData.buffer.byteLength,\r\n          } as File,\r\n        }\r\n      },\r\n      output: 'audio',\r\n      settings: {\r\n        name: `${MODEL_KEY}-settings`,\r\n        type: 'group',\r\n        admin: {\r\n          condition: (data) => {\r\n            return data['model-id'] === `${MODEL_KEY}-m-v2`\r\n          },\r\n        },\r\n        fields,\r\n        label: 'ElevenLabs Multilingual v2 Settings',\r\n      },\r\n    },\r\n  ],\r\n  provider: 'ElevenLabs',\r\n}\r\n"],"names":["generateFileNameByPrompt","generateVoice","getAllVoices","voices","voiceOptions","map","voice","label","name","value","voice_id","fieldVoiceOptions","option","fields","type","admin","initCollapsed","defaultValue","max","min","required","length","unshift","options","MODEL_KEY","ElevenLabsConfig","models","id","handler","text","voiceData","data","alt","file","buffer","mimetype","size","byteLength","output","settings","condition","provider"],"mappings":"AAIA,SAASA,wBAAwB,QAAQ,0CAAyC;AAClF,SAASC,aAAa,QAAQ,qBAAoB;AAClD,SAASC,YAAY,QAAQ,cAAa;AAE1C,MAAM,EAAEC,SAAS,EAAE,EAAE,GAAG,MAAMD;AAE9B,MAAME,eAAeD,OAAOE,GAAG,CAAC,CAACC;IAC/B,OAAO;QACLC,OAAOD,MAAME,IAAI;QACjBC,OAAOH,MAAMI,QAAQ;QACrB,GAAGJ,KAAK;IACV;AACF;AAEA,MAAMK,oBAAoBP,aAAaC,GAAG,CAAC,CAACO;IAC1C,OAAO;QACLL,OAAOK,OAAOJ,IAAI;QAClBC,OAAOG,OAAOF,QAAQ;IACxB;AACF;AAEA,MAAMG,SAAkB;IACtB;QACEC,MAAM;QACNC,OAAO;YACLC,eAAe;QACjB;QACAH,QAAQ;YACN;gBACEL,MAAM;gBACNM,MAAM;gBACNG,cAAc;gBACdV,OAAO;gBACPW,KAAK;gBACLC,KAAK;gBACLC,UAAU;YACZ;YACA;gBACEZ,MAAM;gBACNM,MAAM;gBACNG,cAAc;gBACdV,OAAO;gBACPW,KAAK;gBACLC,KAAK;gBACLC,UAAU;YACZ;YACA;gBACEZ,MAAM;gBACNM,MAAM;gBACNG,cAAc;gBACdV,OAAO;gBACPW,KAAK;gBACLC,KAAK;YACP;YACA;gBACEX,MAAM;gBACNM,MAAM;gBACNP,OAAO;YACT;SACD;QACDA,OAAO;IACT;IACA;QACEC,MAAM;QACNM,MAAM;QACNP,OAAO;IACT;IACA;QACEO,MAAM;QACND,QAAQ;YACN;gBACEL,MAAM;gBACNM,MAAM;gBACNP,OAAO;YACT;YACA;gBACEC,MAAM;gBACNM,MAAM;gBACNP,OAAO;YACT;SACD;IACH;CACD;AAED,IAAIH,aAAaiB,MAAM,EAAE;IACvBR,OAAOS,OAAO,CAAC;QACbd,MAAM;QACNM,MAAM;QACNG,cAAcb,YAAY,CAAC,EAAE,EAAEM;QAC/BH,OAAO;QACPgB,SAASZ;QACTS,UAAU;IACZ;AACF;AAEA,MAAMI,YAAY;AAElB,OAAO,MAAMC,mBAAqC;IAChDC,QAAQ;QACN;YACEC,IAAI,CAAC,EAAEH,UAAU,KAAK,CAAC;YACvBhB,MAAM;YACNK,QAAQ;gBAAC;aAAS;YAClBe,SAAS,OAAOC,MAAcN;gBAC5B,MAAMO,YAAY,MAAM7B,cAAc4B,MAAMN;gBAC5C,OAAO;oBACLQ,MAAM;wBACJC,KAAK;oBACP;oBACAC,MAAM;wBACJzB,MAAM,CAAC,MAAM,EAAER,yBAAyB6B,MAAM,IAAI,CAAC;wBACnDE,MAAMD,UAAUI,MAAM;wBACtBC,UAAU;wBACVC,MAAMN,UAAUI,MAAM,CAACG,UAAU;oBACnC;gBACF;YACF;YACAC,QAAQ;YACRC,UAAU;gBACR/B,MAAM,CAAC,EAAEgB,UAAU,SAAS,CAAC;gBAC7BV,MAAM;gBACNC,OAAO;oBACLyB,WAAW,CAACT;wBACV,OAAOA,IAAI,CAAC,WAAW,KAAK,CAAC,EAAEP,UAAU,KAAK,CAAC;oBACjD;gBACF;gBACAX;gBACAN,OAAO;YACT;QACF;KACD;IACDkC,UAAU;AACZ,EAAC"}