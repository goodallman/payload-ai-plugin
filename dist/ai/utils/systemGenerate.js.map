{"version":3,"sources":["../../../src/ai/utils/systemGenerate.ts"],"sourcesContent":["import { anthropic } from '@ai-sdk/anthropic'\r\nimport { generateText } from 'ai'\r\n\r\nimport { PLUGIN_DEFAULT_ANTHROPIC_MODEL, PLUGIN_DEFAULT_OPENAI_MODEL } from '../../defaults.js'\r\nimport { openai } from '../models/openai/openai.js'\r\n\r\nexport const systemGenerate = async (\r\n  data: { prompt: string; system: string },\r\n  generateTextFn?: (prompt: string, system: string) => Promise<string>,\r\n) => {\r\n  const { prompt, system } = data\r\n\r\n  if (generateTextFn) {\r\n    return generateTextFn(prompt, system)\r\n  }\r\n\r\n  let model = null\r\n\r\n  // If the generateTextFn is not provided, still need OPENAI_API_KEY or ANTHROPIC_API_KEY to initialize\r\n  if (process.env.OPENAI_API_KEY) {\r\n    model = openai(PLUGIN_DEFAULT_OPENAI_MODEL)\r\n  } else if (process.env.ANTHROPIC_API_KEY) {\r\n    model = anthropic(PLUGIN_DEFAULT_ANTHROPIC_MODEL)\r\n  } else {\r\n    throw new Error('- AI Plugin: Please check your environment variables!')\r\n  }\r\n\r\n  const { text } = await generateText({\r\n    model,\r\n    prompt,\r\n    system,\r\n  })\r\n\r\n  return text\r\n}\r\n"],"names":["anthropic","generateText","PLUGIN_DEFAULT_ANTHROPIC_MODEL","PLUGIN_DEFAULT_OPENAI_MODEL","openai","systemGenerate","data","generateTextFn","prompt","system","model","process","env","OPENAI_API_KEY","ANTHROPIC_API_KEY","Error","text"],"mappings":"AAAA,SAASA,SAAS,QAAQ,oBAAmB;AAC7C,SAASC,YAAY,QAAQ,KAAI;AAEjC,SAASC,8BAA8B,EAAEC,2BAA2B,QAAQ,oBAAmB;AAC/F,SAASC,MAAM,QAAQ,6BAA4B;AAEnD,OAAO,MAAMC,iBAAiB,OAC5BC,MACAC;IAEA,MAAM,EAAEC,MAAM,EAAEC,MAAM,EAAE,GAAGH;IAE3B,IAAIC,gBAAgB;QAClB,OAAOA,eAAeC,QAAQC;IAChC;IAEA,IAAIC,QAAQ;IAEZ,sGAAsG;IACtG,IAAIC,QAAQC,GAAG,CAACC,cAAc,EAAE;QAC9BH,QAAQN,OAAOD;IACjB,OAAO,IAAIQ,QAAQC,GAAG,CAACE,iBAAiB,EAAE;QACxCJ,QAAQV,UAAUE;IACpB,OAAO;QACL,MAAM,IAAIa,MAAM;IAClB;IAEA,MAAM,EAAEC,IAAI,EAAE,GAAG,MAAMf,aAAa;QAClCS;QACAF;QACAC;IACF;IAEA,OAAOO;AACT,EAAC"}