{"version":3,"sources":["../../../src/libraries/handlebars/helpers.ts"],"sourcesContent":["import type { SerializedEditorState } from 'lexical'\r\n\r\nimport { getFieldInfo } from '../../utilities/getFieldInfo.js'\r\nimport { lexicalToHTML } from '../../utilities/lexicalToHTML.js'\r\nimport { asyncHandlebars } from './asyncHandlebars.js'\r\nimport { handlebarsHelpersMap } from './helpersMap.js'\r\n\r\nexport const registerEditorHelper = (payload, schemaPath) => {\r\n  //TODO: add autocomplete ability using handlebars template on PromptEditorField and include custom helpers in dropdown\r\n\r\n  let fieldInfo = getFieldInfo(payload.collections, schemaPath)\r\n  const schemaPathChunks = schemaPath.split('.')\r\n\r\n  asyncHandlebars.registerHelper(\r\n    handlebarsHelpersMap.toHTML.name,\r\n    async function (content: SerializedEditorState, options) {\r\n      const collectionSlug = schemaPathChunks[0]\r\n      const { ids } = options\r\n      for (const id of ids) {\r\n        //TODO: Find a better way to get schemaPath of defined field in prompt editor\r\n        const path = `${collectionSlug}.${id}`\r\n        fieldInfo = getFieldInfo(payload.collections, path)\r\n      }\r\n\r\n      const html = await lexicalToHTML(content, fieldInfo.editor?.editorConfig)\r\n      return new asyncHandlebars.SafeString(html)\r\n    },\r\n  )\r\n}\r\n"],"names":["getFieldInfo","lexicalToHTML","asyncHandlebars","handlebarsHelpersMap","registerEditorHelper","payload","schemaPath","fieldInfo","collections","schemaPathChunks","split","registerHelper","toHTML","name","content","options","collectionSlug","ids","id","path","html","editor","editorConfig","SafeString"],"mappings":"AAEA,SAASA,YAAY,QAAQ,kCAAiC;AAC9D,SAASC,aAAa,QAAQ,mCAAkC;AAChE,SAASC,eAAe,QAAQ,uBAAsB;AACtD,SAASC,oBAAoB,QAAQ,kBAAiB;AAEtD,OAAO,MAAMC,uBAAuB,CAACC,SAASC;IAC5C,sHAAsH;IAEtH,IAAIC,YAAYP,aAAaK,QAAQG,WAAW,EAAEF;IAClD,MAAMG,mBAAmBH,WAAWI,KAAK,CAAC;IAE1CR,gBAAgBS,cAAc,CAC5BR,qBAAqBS,MAAM,CAACC,IAAI,EAChC,eAAgBC,OAA8B,EAAEC,OAAO;QACrD,MAAMC,iBAAiBP,gBAAgB,CAAC,EAAE;QAC1C,MAAM,EAAEQ,GAAG,EAAE,GAAGF;QAChB,KAAK,MAAMG,MAAMD,IAAK;YACpB,6EAA6E;YAC7E,MAAME,OAAO,CAAC,EAAEH,eAAe,CAAC,EAAEE,GAAG,CAAC;YACtCX,YAAYP,aAAaK,QAAQG,WAAW,EAAEW;QAChD;QAEA,MAAMC,OAAO,MAAMnB,cAAca,SAASP,UAAUc,MAAM,EAAEC;QAC5D,OAAO,IAAIpB,gBAAgBqB,UAAU,CAACH;IACxC;AAEJ,EAAC"}